@using Blazor.ViewModels
@using Blazor.Data.Models
@implements IDisposable
@inject RedrawEventPublisher Redrawer

<path stroke="black" fill="none" d="M @(Link.TargetPoint.x) @(Link.TargetPoint.y) C @(Link.TargetPoint.x + 50) @(Link.TargetPoint.y), @(Link.SourcePoint.x - 50) @(Link.SourcePoint.y), @(Link.SourcePoint.x) @(Link.SourcePoint.y)"></path>

@code {
    [Parameter] public FkLink Link { get; set; } = null!;

    protected override void OnInitialized()
    {
        Redrawer.OnRedraw += RedrawLine;
    }

    private void RedrawLine()
    {
        Console.WriteLine("I should redraw my line");
        Console.WriteLine("y coord from link: " + Link.SourcePoint.y);
        StateHasChanged();
    }

    public void Dispose()
    {
        Redrawer.OnRedraw -= RedrawLine;
    }

}